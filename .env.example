# Base de datos PostgreSQL
DATABASE_URL="postgresql://usuario:password@localhost:5432/oral7"

# NextAuth.js
NEXTAUTH_SECRET="tu-secreto-super-seguro-generado-con-openssl-rand-base64-32"
NEXTAUTH_URL="http://localhost:3000"

# Modo de desarrollo (true/false)
# En desarrollo, permite login simulado sin OAuth
DEV_MODE="true"

# Redis para rate limiting (Railway, Upstash, o Redis estándar)
REDIS_URL="redis://localhost:6379"

# Feature flags de seguridad para rollout gradual de autenticación
# Login rate limiting para callback/credentials (OFF por defecto)
AUTH_LOGIN_RATE_LIMIT_ENABLED="false"
# Modo recomendado para rollout gradual:
# off | monitor | enforce
AUTH_LOGIN_RATE_LIMIT_MODE="off"
# Timeout de operación de rate limit para login (evita "login pensando")
AUTH_LOGIN_RATE_LIMIT_TIMEOUT_MS="500"

# 2FA para cuentas ADMIN en login (OFF por defecto)
AUTH_ADMIN_2FA_ENABLED="false"
# Si está en true y faltan columnas/campos de 2FA en DB, bloqueará login admin.
AUTH_ADMIN_2FA_STRICT="false"
# Controla visibilidad del campo 2FA en la UI de login
NEXT_PUBLIC_AUTH_ADMIN_2FA_ENABLED="false"

# Redis rate limiting (fail-fast)
RATE_LIMIT_REDIS_CONNECT_TIMEOUT_MS="2000"
RATE_LIMIT_REDIS_COMMAND_TIMEOUT_MS="1000"
RATE_LIMIT_REDIS_MAX_RETRIES="1"
RATE_LIMIT_OPERATION_TIMEOUT_MS="1500"

# Escaneo antivirus de archivos (ClamAV)
# En producción el escaneo es obligatorio (fail-closed).
# En desarrollo puedes activar escaneo con FILE_SCANNING_ENABLED=true
FILE_SCANNING_ENABLED="false"
# Fuerza escaneo también en desarrollo/testing
FILE_SCANNING_REQUIRED="false"
CLAMAV_HOST="127.0.0.1"
CLAMAV_PORT="3310"
CLAMAV_TIMEOUT_MS="10000"
CLAMAV_MAX_SCAN_BYTES="104857600"
